## Copyright (C) 2026 Andreas Bertsatos <abertsatos@biol.uoa.gr>
##
## This file is part of the datatypes package for GNU Octave.
##
## This program is free software; you can redistribute it and/or modify it under
## the terms of the GNU General Public License as published by the Free Software
## Foundation; either version 3 of the License, or (at your option) any later
## version.
##
## This program is distributed in the hope that it will be useful, but WITHOUT
## ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
## FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more
## details.
##
## You should have received a copy of the GNU General Public License along with
## this program; if not, see <http://www.gnu.org/licenses/>.

################################################################################
##             ** Create and convert 'calendarDuration' type **               ##
################################################################################
##                             Available Methods                              ##
##                                                                            ##
## 'duration'         'dispstrings'      'cellstr'          'char'            ##
## 'datevec'          'time'             'split'            'caldays'         ##
## 'calweeks'         'calmonths'        'calquarters'      'calyears'        ##
##                                                                            ##
################################################################################

%!assert (isscalar (calendarDuration ()), true)
%!assert (class (calendarDuration), 'calendarDuration')
%!assert (dispstrings (calendarDuration ()), {'0d'})
%!assert (size (calendarDuration (zeros (4, 3))), [4, 1])
%!assert (size (calendarDuration (ones (5, 6))), [5, 1])
%!test
%! X = calendarDuration ([0, 0, 1]);
%! assert (caldays (X), 1);
%! assert (dispstrings (X), {'1d'});
%! assert (char (X), '1d');
%!test
%! X = calendarDuration ([0, 2, 14]);
%! assert (caldays (X), 14);
%! assert (calweeks (X), 2);
%! assert (calmonths (X), 2);
%! assert (char (X), '2mo 14d');
%!test
%! X = calendarDuration ([1, 5, 15]);
%! assert (caldays (X), 15);
%! assert (calweeks (X), 2);
%! assert (calmonths (X), 17);
%! assert (calquarters (X), 5);
%! assert (dispstrings (X), {'1y 5mo 15d'});
%! assert (char (X, 'mdt'), '17mo 15d');
%! assert (cellstr (X, 'mwdt'), {'17mo 2w 1d'});
%!test
%! X = calendarDuration ([1, 0, 0, 12, 30, 6.5]);
%! assert (caldays (X), 0);
%! assert (calweeks (X), 0);
%! assert (calmonths (X), 12);
%! assert (calquarters (X), 4);
%! assert (dispstrings (X), {'1y 12h 30m 6.5s'});
%! assert (class (time (X)), 'duration');
%! assert (hours (time (X)), 12.5018, 1e-4);
%! assert (minutes (time (X)), 750.1083, 1e-4);
%! assert (seconds (time (X)), 45006.5);
%!assert (size (calendarDuration ([1, 2; 9, 8], 0, 1)), [2, 2])
%!assert (size (calendarDuration (1, zeros (2, 3, 4), 1)), [2, 3, 4])
%!test
%! X = calendarDuration (0, 0, 1);
%! assert (caldays (X), 1);
%! assert (dispstrings (X), {'1d'});
%! assert (char (X), '1d');
%!test
%! X = calendarDuration ([0, 2, 14]);
%! assert (caldays (X), 14);
%! assert (calweeks (X), 2);
%! assert (calmonths (X), 2);
%! assert (char (X), '2mo 14d');
%!test
%! X = calendarDuration (1, 5, 15);
%! assert (caldays (X), 15);
%! assert (calweeks (X), 2);
%! assert (calmonths (X), 17);
%! assert (calquarters (X), 5);
%! assert (dispstrings (X), {'1y 5mo 15d'});
%! assert (char (X, 'mdt'), '17mo 15d');
%! assert (cellstr (X, 'mwdt'), {'17mo 2w 1d'});
%!test
%! X = calendarDuration ([1;NaN], 2, 3);
%! assert (char (X(1)), '1y 2mo 3d');
%! assert (char (X(2)), 'NaN');
%!assert (size (calendarDuration (1, 2, 1, days (ones (2, 3, 4)))), [2, 3, 4])
%!test
%! X = calendarDuration (1, 0, 0, duration (12, 30, 6.5));
%! assert (caldays (X), 0);
%! assert (calweeks (X), 0);
%! assert (calmonths (X), 12);
%! assert (calquarters (X), 4);
%! assert (dispstrings (X), {'1y 12h 30m 6.5s'});
%! assert (class (time (X)), 'duration');
%! assert (hours (time (X)), 12.5018, 1e-4);
%! assert (minutes (time (X)), 750.1083, 1e-4);
%! assert (seconds (time (X)), 45006.5);
%!test
%! X = calendarDuration (1, 0, 0, 12, 30, 6.5);
%! assert (caldays (X), 0);
%! assert (calweeks (X), 0);
%! assert (calmonths (X), 12);
%! assert (calquarters (X), 4);
%! assert (dispstrings (X), {'1y 12h 30m 6.5s'});
%! assert (class (time (X)), 'duration');
%! assert (hours (time (X)), 12.5018, 1e-4);
%! assert (minutes (time (X)), 750.1083, 1e-4);
%! assert (seconds (time (X)), 45006.5);
%!test
%! X = calendarDuration ([1, NaN], 0, 0, 12, 30, 6.5);
%! assert (caldays (X(1)), 0);
%! assert (calweeks (X(1)), 0);
%! assert (calmonths (X(1)), 12);
%! assert (calquarters (X(1)), 4);
%! assert (dispstrings (X(1)), {'1y 12h 30m 6.5s'});
%! assert (class (time (X(1))), 'duration');
%! assert (hours (time (X(1))), 12.5018, 1e-4);
%! assert (minutes (time (X(1))), 750.1083, 1e-4);
%! assert (seconds (time (X(1))), 45006.5);
%! assert (caldays (X(2)), NaN);
%! assert (calweeks (X(2)), NaN);
%! assert (calmonths (X(2)), NaN);
%! assert (calquarters (X(2)), NaN);
%! assert (char (X(2)), 'NaN');
%! assert (class (time (X(2))), 'duration');
%! assert (hours (time (X(2))), NaN);
%! assert (minutes (time (X(2))), NaN);
%! assert (seconds (time (X(2))), NaN);
%!error<calendarDuration: 'Format' must be a character vector.> ...
%! calendarDuration ([0, 0, 1], 'Format', 1)
%!error<calendarDuration: 'Format' must be a character vector.> ...
%! calendarDuration ([0, 0, 1], 'Format', {'YY-MM-DD'})
%!error<calendarDuration: 'Format' contains duplicate characters.> ...
%! calendarDuration ([0, 0, 1], 'Format', 'yymd')
%!error<calendarDuration: 'Format' must contain 'm', 'd', and 't'.> ...
%! calendarDuration ([0, 0, 1], 'Format', 'ymd')
%!error<calendarDuration: 'Format' has invalid order of characters.> ...
%! calendarDuration ([0, 0, 1], 'Format', 'mtd')
%!error<calendarDuration: X must be a numeric matrix.> calendarDuration ({0, 0})
%!error<calendarDuration: X must be a numeric matrix.> calendarDuration ('asd')
%!error<calendarDuration: X must be real.> calendarDuration (1+i)
%!error<calendarDuration: years, months, and days must be integer values.> ...
%! calendarDuration ([0.5, 1, 1])
%!error<calendarDuration: years, months, and days must be integer values.> ...
%! calendarDuration ([1, 0.5, 1])
%!error<calendarDuration: years, months, and days must be integer values.> ...
%! calendarDuration ([1, 1, 0.5])
%!error<calendarDuration: years, months, days, hours, and minutes must be integer values.> ...
%! calendarDuration ([0.5, 0, 0, 0, 0, 0])
%!error<calendarDuration: years, months, days, hours, and minutes must be integer values.> ...
%! calendarDuration ([0, 0.5, 0, 0, 0, 0])
%!error<calendarDuration: years, months, days, hours, and minutes must be integer values.> ...
%! calendarDuration ([0, 0, 0.5, 0, 0, 0])
%!error<calendarDuration: years, months, days, hours, and minutes must be integer values.> ...
%! calendarDuration ([0, 0, 0, 0.5, 0, 0])
%!error<calendarDuration: years, months, days, hours, and minutes must be integer values.> ...
%! calendarDuration ([0, 0, 0, 0, 0.5, 0])
%!error<calendarDuration: X must have either 3 or 6 columns.> ...
%! calendarDuration ([1, 1])
%!error<calendarDuration: X must have either 3 or 6 columns.> ...
%! calendarDuration ([1, 1, 1, 0.5, 0])
%!error<calendarDuration: Y, MO, and D must be a numeric arrays.> ...
%! calendarDuration ('a', 2, 3)
%!error<calendarDuration: Y, MO, and D must be a numeric arrays.> ...
%! calendarDuration (1, {2}, 3)
%!error<calendarDuration: Y, MO, and D must be a numeric arrays.> ...
%! calendarDuration (1, 2, {'s'})
%!error<calendarDuration: Y, MO, and D must be real.> calendarDuration (i, 2, 3)
%!error<calendarDuration: Y, MO, and D must be real.> calendarDuration (1, i, 3)
%!error<calendarDuration: Y, MO, and D must be real.> calendarDuration (1, 2, i)
%!error<calendarDuration: Y, MO, and D must be of common size or scalars.> ...
%! calendarDuration ([1, 2], 2, [1; 2])
%!error<calendarDuration: years, months, and days must be integer values.> ...
%! calendarDuration (1.2, 2, 3)
%!error<calendarDuration: years, months, and days must be integer values.> ...
%! calendarDuration (1, 2.5, 3)
%!error<calendarDuration: years, months, and days must be integer values.> ...
%! calendarDuration (1, 2, 0.3)
%!error<calendarDuration: Y, MO, and D must be a numeric arrays.> ...
%! calendarDuration ('a', 2, 3, days (1))
%!error<calendarDuration: Y, MO, and D must be a numeric arrays.> ...
%! calendarDuration (1, {2}, 3, days (1))
%!error<calendarDuration: Y, MO, and D must be a numeric arrays.> ...
%! calendarDuration (1, 2, {'s'}, days (1))
%!error<calendarDuration: Y, MO, and D must be real.> ...
%! calendarDuration (i, 2, 3, days (1))
%!error<calendarDuration: Y, MO, and D must be real.> ...
%! calendarDuration (1, i, 3, days (1))
%!error<calendarDuration: Y, MO, and D must be real.> ...
%! calendarDuration (1, 2, i, days (1))
%!error<calendarDuration: T must be a duration array.> ...
%! calendarDuration (1, 2, 3, 2)
%!error<calendarDuration: Y, MO, D, and T must be of common size or scalars.> ...
%! calendarDuration ([1, 2], 2, 1, days ([1; 2]))
%!error<calendarDuration: years, months, and days must be integer values.> ...
%! calendarDuration (1.2, 2, 3, days (1))
%!error<calendarDuration: years, months, and days must be integer values.> ...
%! calendarDuration (1, 2.5, 3, days (1))
%!error<calendarDuration: years, months, and days must be integer values.> ...
%! calendarDuration (1, 2, 0.3, days (1))
%!error<calendarDuration: Y, MO, D, H, MI, and S must be numeric arrays.> ...
%! calendarDuration ('a', 0, 0, 12, 30, 6.5)
%!error<calendarDuration: Y, MO, D, H, MI, and S must be numeric arrays.> ...
%! calendarDuration (1, {0}, 0, 12, 30, 6.5)
%!error<calendarDuration: Y, MO, D, H, MI, and S must be numeric arrays.> ...
%! calendarDuration (1, 0, string (0), 12, 30, 6.5)
%!error<calendarDuration: Y, MO, D, H, MI, and S must be numeric arrays.> ...
%! calendarDuration (1, 0, 0, {12}, 30, 6.5)
%!error<calendarDuration: Y, MO, D, H, MI, and S must be numeric arrays.> ...
%! calendarDuration (1, 0, 0, 12, '30', 6.5)
%!error<calendarDuration: Y, MO, D, H, MI, and S must be numeric arrays.> ...
%! calendarDuration (1, 0, 0, 12, 30, struct ('s', 6.5))
%!error<calendarDuration: numeric input data must be real.> ...
%! calendarDuration (i, 0, 0, 12, 30, 6.5)
%!error<calendarDuration: numeric input data must be real.> ...
%! calendarDuration (1, i, 0, 12, 30, 6.5)
%!error<calendarDuration: numeric input data must be real.> ...
%! calendarDuration (1, 0, i, 12, 30, 6.5)
%!error<calendarDuration: numeric input data must be real.> ...
%! calendarDuration (1, 0, 0, i, 30, 6.5)
%!error<calendarDuration: numeric input data must be real.> ...
%! calendarDuration (1, 0, 0, 12, i, 6.5)
%!error<calendarDuration: numeric input data must be real.> ...
%! calendarDuration (1, 0, 0, 12, 30, i)
%!error<calendarDuration: Y, MO, D, H, MI, and S must be of common size or scalars.> ...
%! calendarDuration ([1, 2], 0, [0; 0], 12, 30, 6.5)
%!error<calendarDuration: years, months, days, hours, and minutes must be integer values.> ...
%! calendarDuration (1.2, 0, 1, 12, 30, 6.5)
%!error<calendarDuration: years, months, days, hours, and minutes must be integer values.> ...
%! calendarDuration (1, [0.1, NaN], 1, 12, 30, 6.5)
%!error<calendarDuration: years, months, days, hours, and minutes must be integer values.> ...
%! calendarDuration (1, 0, 1.5, 12, 30, 6.5)
%!error<calendarDuration: years, months, days, hours, and minutes must be integer values.> ...
%! calendarDuration (1, 0, 1, 1.2, 30, 6.5)
%!error<calendarDuration: years, months, days, hours, and minutes must be integer values.> ...
%! calendarDuration (1, 0, 1, 12, 29.5, 6.5)
%!error<calendarDuration: invalid number of input arguments.> ...
%! calendarDuration (1, [0.1, NaN])
%!error<calendarDuration: invalid number of input arguments.> ...
%! calendarDuration (1, [0.1, NaN], 1, 12, 30)

%!assert (dispstrings (calendarDuration ([0, 0, NaN])), {'NaN'})
%!assert (dispstrings (calendarDuration ([0, 0, Inf])), {'Inf'})
%!assert (dispstrings (calendarDuration ([0, NaN, Inf])), {'NaN'})
%!assert (dispstrings (calendarDuration ([0, 0, -Inf])), {'-Inf'})
%!assert (dispstrings (calendarDuration ([0, Inf, -Inf])), {'NaN'})
%!assert (char (calendarDuration (0, 0, NaN)), 'NaN')
%!assert (char (calendarDuration (0, 0, Inf)), 'Inf')
%!assert (char (calendarDuration (0, NaN, Inf)), 'NaN')
%!assert (char (calendarDuration (0, 0, -Inf)), '-Inf')
%!assert (char (calendarDuration (0, Inf, -Inf)), 'NaN')
%!assert (dispstrings (calendarDuration (1, 3, 1, 'Format', 'mwdt')), {'15mo 1d'})
%!assert (dispstrings (calendarDuration (1, 3, 1, 'Format', 'ymwdt')), {'1y 3mo 1d'})
%!assert (dispstrings (calendarDuration (1, 3, 15, 'Format', 'ymwdt')), {'1y 3mo 2w 1d'})
%!assert (dispstrings (calendarDuration (1, 3, 15, 'Format', 'mwdt')), {'15mo 2w 1d'})
%!assert (dispstrings (calendarDuration (1, 3, 15, 'Format', 'ymdt')), {'1y 3mo 15d'})
%!assert (dispstrings (calendarDuration (1, 3, 15, 'Format', 'mdt')), {'15mo 15d'})
%!assert (dispstrings (calendarDuration (0, 15, 15, 'Format', 'ymdt')), {'1y 3mo 15d'})
%!assert (dispstrings (calendarDuration (0, 0, 0)), {'0d'})
%!assert (dispstrings (calendarDuration (1, 0, 0)), {'1y'})
%!assert (dispstrings (calendarDuration (0, 1, 0)), {'1mo'})
%!assert (dispstrings (calendarDuration (0, 12, 0)), {'1y'})
%!assert (dispstrings (calendarDuration (0, 0, 1)), {'1d'})
%!assert (dispstrings (calendarDuration (0, 0, 14)), {'14d'})
%!assert (dispstrings (calendarDuration (0, 0, 14, 'Format', 'mwdt')), {'2w'})
%!assert (dispstrings (calendarDuration (0, 1, 0, minutes (5))), {'1mo 0h 5m 0s'})
%!assert (dispstrings (calendarDuration (0, 0, 0, minutes (5))), {'0h 5m 0s'})
%!assert (dispstrings (calendarDuration (0, 0, 0, minutes (50.05))), {'0h 50m 3s'})
%!assert (dispstrings (calendarDuration (0, 0, 0, minutes (5.005))), {'0h 5m 0.3s'})
%!assert (dispstrings (calendarDuration (0, 0, 0, minutes (5.000005))), {'0h 5m 3e-04s'})
%!assert (dispstrings (calendarDuration (0, 0, 0, duration (3, 5, 0.3))), {'3h 5m 0.3s'})

%!assert (cellstr (calendarDuration (1, 3, 1), 'mwdt'), {'15mo 1d'})
%!assert (cellstr (calendarDuration (1, 3, 1), 'ymwdt'), {'1y 3mo 1d'})
%!assert (cellstr (calendarDuration (1, 3, 15), 'ymwdt'), {'1y 3mo 2w 1d'})
%!assert (cellstr (calendarDuration (1, 3, 15), 'mwdt'), {'15mo 2w 1d'})
%!assert (cellstr (calendarDuration (1, 3, 15), 'ymdt'), {'1y 3mo 15d'})
%!assert (cellstr (calendarDuration (1, 3, 15), 'mdt'), {'15mo 15d'})
%!assert (cellstr (calendarDuration (0, 15, 15), 'ymdt'), {'1y 3mo 15d'})
%!assert (cellstr (calendarDuration (0, 0, 0)), {'0d'})
%!assert (cellstr (calendarDuration (1, 0, 0)), {'1y'})
%!assert (cellstr (calendarDuration (0, 1, 0)), {'1mo'})
%!assert (cellstr (calendarDuration (0, 12, 0)), {'1y'})
%!assert (cellstr (calendarDuration (0, 0, 1)), {'1d'})
%!assert (cellstr (calendarDuration (0, 0, 14)), {'14d'})
%!assert (cellstr (calendarDuration (0, 0, 14), 'mwdt'), {'2w'})
%!assert (cellstr (calendarDuration (0, 1, 0, minutes (5))), {'1mo 0h 5m 0s'})
%!assert (cellstr (calendarDuration (0, 0, 0, minutes (5))), {'0h 5m 0s'})
%!assert (cellstr (calendarDuration (0, 0, 0, minutes (50.05))), {'0h 50m 3s'})
%!assert (cellstr (calendarDuration (0, 0, 0, minutes (5.005))), {'0h 5m 0.3s'})
%!assert (cellstr (calendarDuration (0, 0, 0, minutes (5.000005))), {'0h 5m 3e-04s'})
%!assert (cellstr (calendarDuration (0, 0, 0, duration (3, 5, 0.3))), {'3h 5m 0.3s'})
%!error<calendarDuration.cellstr: FMT must be a character vector.> ...
%! cellstr (calendarDuration ([0, 0, 1]), 1)
%!error<calendarDuration.cellstr: FMT must be a character vector.> ...
%! cellstr (calendarDuration ([0, 0, 1]), {'YY-MM-DD'})
%!error<calendarDuration.cellstr: FMT contains duplicate characters.> ...
%! cellstr (calendarDuration ([0, 0, 1]), 'yymd')
%!error<calendarDuration.cellstr: FMT must contain 'm', 'd', and 't'.> ...
%! cellstr (calendarDuration ([0, 0, 1]), 'ymd')
%!error<calendarDuration.cellstr: FMT has invalid order of characters.> ...
%! cellstr (calendarDuration ([0, 0, 1]), 'mtd')

%!assert (char (calendarDuration (1, 3, 1), 'mwdt'), '15mo 1d')
%!assert (char (calendarDuration (1, 3, 1), 'ymwdt'), '1y 3mo 1d')
%!assert (char (calendarDuration (1, 3, 15), 'ymwdt'), '1y 3mo 2w 1d')
%!assert (char (calendarDuration (1, 3, 15), 'mwdt'), '15mo 2w 1d')
%!assert (char (calendarDuration (1, 3, 15), 'ymdt'), '1y 3mo 15d')
%!assert (char (calendarDuration (1, 3, 15), 'mdt'), '15mo 15d')
%!assert (char (calendarDuration (0, 15, 15), 'ymdt'), '1y 3mo 15d')
%!assert (char (calendarDuration (0, 0, 0)), '0d')
%!assert (char (calendarDuration (1, 0, 0)), '1y')
%!assert (char (calendarDuration (0, 1, 0)), '1mo')
%!assert (char (calendarDuration (0, 12, 0)), '1y')
%!assert (char (calendarDuration (0, 0, 1)), '1d')
%!assert (char (calendarDuration (0, 0, 14)), '14d')
%!assert (char (calendarDuration (0, 0, 14), 'mwdt'), '2w')
%!assert (char (calendarDuration (0, 1, 0, minutes (5))), '1mo 0h 5m 0s')
%!assert (char (calendarDuration (0, 0, 0, minutes (5))), '0h 5m 0s')
%!assert (char (calendarDuration (0, 0, 0, minutes (50.05))), '0h 50m 3s')
%!assert (char (calendarDuration (0, 0, 0, minutes (5.005))), '0h 5m 0.3s')
%!assert (char (calendarDuration (0, 0, 0, minutes (5.000005))), '0h 5m 3e-04s')
%!assert (char (calendarDuration (0, 0, 0, duration (3, 5, 0.3))), '3h 5m 0.3s')
%!error<calendarDuration.char: FMT must be a character vector.> ...
%! char (calendarDuration ([0, 0, 1]), 1)
%!error<calendarDuration.char: FMT must be a character vector.> ...
%! char (calendarDuration ([0, 0, 1]), {'YY-MM-DD'})
%!error<calendarDuration.char: FMT contains duplicate characters.> ...
%! char (calendarDuration ([0, 0, 1]), 'yymd')
%!error<calendarDuration.char: FMT must contain 'm', 'd', and 't'.> ...
%! char (calendarDuration ([0, 0, 1]), 'ymd')
%!error<calendarDuration.char: FMT has invalid order of characters.> ...
%! char (calendarDuration ([0, 0, 1]), 'mtd')

%!test
%! X = calendarDuration ([1:5]', 3, 15);
%! DV = datevec (X);
%! assert (size (X), [5, 1]);
%! assert (size (DV), [5, 6]);
%! assert (DV(:,1:3), [1, 3, 15; 2, 3, 15; 3, 3, 15; 4, 3, 15; 5, 3, 15]);
%! assert (DV(:,4:6), zeros (5, 3));
%!test
%! X = calendarDuration ([1:5]', 3, 15);
%! [Y, MO, D] = datevec (X);
%! assert (size (Y), [5, 1]);
%! assert (size (MO), [5, 1]);
%! assert (size (D), [5, 1]);
%! assert (Y, [1:5]');
%! assert (MO, [3; 3; 3; 3; 3]);
%! assert (D, 15 * ones (5, 1));
%!test
%! X = calendarDuration ([1:5]', 3, 15);
%! [~, ~, ~, H, MI, S] = datevec (X);
%! assert (size (H), [5, 1]);
%! assert (size (MI), [5, 1]);
%! assert (size (S), [5, 1]);
%! assert (H, zeros (5, 1));
%! assert (MI, zeros (5, 1));
%! assert (S, zeros (5, 1));
%!test
%! X = calendarDuration (reshape (1:24, 2, 3, 4), 0, reshape (25:48, 2, 3, 4));
%! DV = datevec (X);
%! assert (size (X), [2, 3, 4]);
%! assert (size (DV), [24, 6]);
%! assert (DV(:,1), [1:24]');
%! assert (DV(:,2), zeros (24, 1));
%! assert (DV(:,3), [25:48]');
%! assert (DV(:,4:6), zeros (24, 3));
%!test
%! X = calendarDuration (reshape (1:24, 2, 3, 4), 0, reshape (25:48, 2, 3, 4));
%! [Y, MO, D] = datevec (X);
%! assert (size (Y), [2, 3, 4]);
%! assert (size (MO), [2, 3, 4]);
%! assert (size (D), [2, 3, 4]);
%! assert (Y, reshape (1:24, 2, 3, 4));
%! assert (MO, zeros (2, 3, 4));
%! assert (D, reshape (25:48, 2, 3, 4));
%!test
%! X = calendarDuration (reshape (1:24, 2, 3, 4), 0, reshape (25:48, 2, 3, 4));
%! [~, ~, ~, H, MI, S] = datevec (X);
%! assert (size (H), [2, 3, 4]);
%! assert (size (MI), [2, 3, 4]);
%! assert (size (S), [2, 3, 4]);
%! assert (H, zeros (2, 3, 4));
%! assert (MI, zeros (2, 3, 4));
%! assert (S, zeros (2, 3, 4));
%!test
%! D = days (0.51);
%! X = calendarDuration (1, 0, 0, D);
%! [Y, ~, ~, H, MI, S] = datevec (X);
%! [h, mi, s] = hms (D);
%! assert (Y, 1);
%! assert (H, h);
%! assert (MI, mi);
%! assert (S, s);
%!test
%! D = days (repmat ([0.51, 0.46; 0.2, 1.23], 1, 2, 3));
%! X = calendarDuration (1, 0, 0, D);
%! [Y, ~, ~, H, MI, S] = datevec (X);
%! [h, mi, s] = hms (D);
%! assert (Y, ones (2, 4, 3));
%! assert (H, h);
%! assert (MI, mi);
%! assert (S, s);
%!test
%! X = calendarDuration (1, 0, 1, 0, reshape (1:24, 2, 3, 4), 0);
%! [Y, MO, D, H, MI, S] = datevec (X);
%! assert (Y, ones (2, 3, 4));
%! assert (MO, zeros (2, 3, 4));
%! assert (D, ones (2, 3, 4));
%! assert (H, zeros (2, 3, 4));
%! assert (MI, reshape (1:24, 2, 3, 4));
%! assert (S, zeros (2, 3, 4));
%! DV = datevec (X);
%! assert (DV(:,[1, 3]), ones (24, 2));
%! assert (DV(:,[2, 4, 6]), zeros (24, 3));
%! assert (DV(:,5), [1:24]');
%!error<calendarDuration.datavec: too many output arguments.> ...
%! [Y, MO, D, H, MI, S, MS] = datevec (calendarDuration)

%!assert (size (time (calendarDuration (1, 1, 1))), [1, 1])
%!assert (size (time (calendarDuration (ones (2, 3, 4), 1, 1))), [2, 3, 4])
%!assert (size (time (calendarDuration (1, 1, 1, days (1)))), [1, 1])
%!assert (size (time (calendarDuration (0, 0, 0, ones (2, 3, 4), 1, 1))), [2, 3, 4])
%!test
%! t = time (calendarDuration (1, 1, 1));
%! assert (class (t), 'duration');
%! [h, m, s] = hms (t);
%! assert (h, 0);
%! assert (m, 0);
%! assert (s, 0);
%!test
%! t = time (calendarDuration (1, ones (2), 1, hours (1.5)));
%! assert (size (t), [2, 2]);
%! [h, m, s] = hms (t);
%! assert (h, ones (2));
%! assert (m, 30 * ones (2));
%! assert (s, zeros (2));
%!test
%! t = time (calendarDuration (1, ones (2), 1, 0, 0, 0.0251));
%! assert (size (t), [2, 2]);
%! [h, m, s] = hms (t);
%! assert (s, [0.0251, 0.0251; 0.0251, 0.0251]);

################################################################################
##                       ** Mathematical Operations **                        ##
################################################################################
##                             Available Methods                              ##
##                                                                            ##
## 'minus'            'uminus'           'plus'             'uplus'           ##
## 'times'            'mtimes'                                                ##
##                                                                            ##
################################################################################

%!test
%! A = caldays ([1, 2, 3]);
%! B = caldays (1);
%! assert (caldays (A - B), [0, 1, 2]);
%! assert (caldays (B - A), [0, -1, -2]);
%!test
%! A = calweeks (1);
%! B = days ([2, 2]);
%! [c1, c2] = split (A - B, {'days', 'time'});
%! assert (c1, [7, 7]);
%! assert (days (c2), [-2, -2]);
%!test
%! A = calweeks (1);
%! B = [2, 2];
%! [c1, c2] = split (A - B, {'days', 'time'});
%! assert (c1, [7, 7]);
%! assert (days (c2), [-2, -2]);
%!test
%! A = days ([2, 2]);
%! B = calweeks (1);
%! [c1, c2] = split (A - B, {'days', 'time'});
%! assert (c1, [-7, -7]);
%! assert (days (c2), [2, 2]);
%!test
%! A = [2, 2];
%! B = calweeks (1);
%! [c1, c2] = split (A - B, {'days', 'time'});
%! assert (c1, [-7, -7]);
%! assert (days (c2), [2, 2]);
%!error <calendarDuration: subtraction is not defined between 'calendarDuration' and 'char' arrays.> ...
%! calweeks (1) - 'a'
%!error <calendarDuration: subtraction is not defined between 'calendarDuration' and 'cell' arrays.> ...
%! calweeks (1) - {1}
%!error <calendarDuration: subtraction is not defined between 'calendarDuration' and 'struct' arrays.> ...
%! calweeks (1) - struct ('a', 1)

%!test
%! A = caldays ([1, 2, 3]);
%! assert (caldays (-A), [-1, -2, -3]);
%!test
%! A = randi (10, 3, 4, 5);
%! B = caldays (A);
%! C = - caldays (A);
%! assert (caldays (B + C), zeros (3, 4, 5));

%!test
%! A = caldays ([1, 2, 3]);
%! B = caldays (1);
%! assert (caldays (A + B), [2, 3, 4]);
%! assert (caldays (B + A), [2, 3, 4]);
%!test
%! A = calweeks (1);
%! B = days ([2, 2]);
%! [c1, c2] = split (A + B, {'days', 'time'});
%! assert (c1, [7, 7]);
%! assert (days (c2), [2, 2]);
%!test
%! A = calweeks (1);
%! B = [2, 2];
%! [c1, c2] = split (A + B, {'days', 'time'});
%! assert (c1, [7, 7]);
%! assert (days (c2), [2, 2]);
%!test
%! A = days ([2, 2]);
%! B = calweeks (1);
%! [c1, c2] = split (A + B, {'days', 'time'});
%! assert (c1, [7, 7]);
%! assert (days (c2), [2, 2]);
%!test
%! A = [2, 2];
%! B = calweeks (1);
%! [c1, c2] = split (A + B, {'days', 'time'});
%! assert (c1, [7, 7]);
%! assert (days (c2), [2, 2]);
%!error <calendarDuration: addition is not defined between 'calendarDuration' and 'char' arrays.> ...
%! calweeks (1) + 'a'
%!error <calendarDuration: addition is not defined between 'calendarDuration' and 'cell' arrays.> ...
%! calweeks (1) + {1}
%!error <calendarDuration: addition is not defined between 'calendarDuration' and 'struct' arrays.> ...
%! calweeks (1) + struct ('a', 1)

%!test
%! A = calendarDuration ([1, 1, 5, 4, 30, 2]);
%! B = A .* [1, 3];
%! [y, m, d, t] = split (B, {'years', 'months', 'days', 'time'});
%! assert (y, [1, 3]);
%! assert (m, [1, 3]);
%! assert (d, [5, 15]);
%! assert (seconds (t), [16202, 48606]);
%!test
%! A = calendarDuration ([1, 1, 5, 4, 30, 2]);
%! B = A .* [1; 3];
%! [y, m, d, t] = split (B, {'years', 'months', 'days', 'time'});
%! assert (y, [1; 3]);
%! assert (m, [1; 3]);
%! assert (d, [5; 15]);
%! assert (seconds (t), [16202; 48606]);
%!test
%! A = calendarDuration ([1, 1, 5, 4, 30, 2]);
%! B = [1; 3] .* A;
%! [y, m, d, t] = split (B, {'years', 'months', 'days', 'time'});
%! assert (y, [1; 3]);
%! assert (m, [1; 3]);
%! assert (d, [5; 15]);
%! assert (seconds (t), [16202; 48606]);
%!test
%! A = calendarDuration ([1, 1, 5, 4, 30, 2]);
%! B = 2 .* A;
%! [y, m, d, t] = split (B, {'years', 'months', 'days', 'time'});
%! assert (y, 2);
%! assert (m, 2);
%! assert (d, 10);
%! assert (seconds (t), 32404);
%!error <calendarDuration: multiplication is not defined between 'calendarDuration' and 'char' arrays.> ...
%! calweeks (1) .* 'a'
%!error <calendarDuration: multiplication is not defined between 'calendarDuration' and 'cell' arrays.> ...
%! calweeks (1) .* {1}
%!error <calendarDuration: multiplication is not defined between 'calendarDuration' and 'struct' arrays.> ...
%! calweeks (1) .* struct ('a', 1)

%!test
%! A = calendarDuration ([1, 1, 5, 4, 30, 2]);
%! B = 2 * A;
%! [y, m, d, t] = split (B, {'years', 'months', 'days', 'time'});
%! assert (y, 2);
%! assert (m, 2);
%! assert (d, 10);
%! assert (seconds (t), 32404);
%!test
%! A = calendarDuration ([1, 2], 0, [4, 5]);
%! B = A * [1; 2];
%! [y, d] = split (B, {'years', 'days'});
%! assert (y, [1, 2] * [1; 2]);
%! assert (d, [4, 5] * [1; 2]);
%!test
%! A = calendarDuration ([1, 2], 0, [4, 5]);
%! B = A * [4; 2];
%! [y, d] = split (B, {'years', 'days'});
%! assert (y, [1, 2] * [4; 2]);
%! assert (d, [4, 5] * [4; 2]);
%!test
%! A = calendarDuration ([1, 2], 0, [4, 5]);
%! B = [4; 2] * A;
%! [y, d] = split (B, {'years', 'days'});
%! assert (y, [4; 2] * [1, 2]);
%! assert (d, [4; 2] * [4, 5]);
%!error <calendarDuration: matrix multiplication is not defined between 'calendarDuration' and 'char' arrays.> ...
%! calweeks (1) * 'a'
%!error <calendarDuration: matrix multiplication is not defined between 'calendarDuration' and 'cell' arrays.> ...
%! calweeks (1) * {1}
%!error <calendarDuration: matrix multiplication is not defined between 'calendarDuration' and 'struct' arrays.> ...
%! calweeks (1) * struct ('a', 1)
